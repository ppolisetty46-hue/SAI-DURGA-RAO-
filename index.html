<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Whole Class Marks</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:#f2f3f7}

/* INDEX PAGE */
#index{
height:100vh;display:flex;align-items:center;justify-content:center;
background:linear-gradient(135deg,#667eea,#764ba2);
color:#fff;text-align:center
}
#index h1{font-size:40px}
#index button{
padding:14px 36px;border:none;border-radius:30px;
font-size:18px;background:#fff;color:#667eea;font-weight:bold;
cursor:pointer
}

/* HEADER */
.header{
background:#667eea;color:#fff;padding:16px;
text-align:center;font-size:20px;font-weight:bold
}

/* SCREENS */
.screen{display:none;padding:12px}
.active{display:block}

/* CARD */
.card{
background:#fff;border-radius:16px;padding:14px;
max-width:1200px;margin:auto;
box-shadow:0 8px 25px rgba(0,0,0,.15)
}

input,button{
padding:8px;border-radius:8px;
border:1px solid #ccc;font-size:14px
}
button{
background:#667eea;color:#fff;border:none;font-weight:bold;cursor:pointer
}

/* TABLE */
.table-wrap{
overflow-x:auto;margin-top:10px
}
table{
border-collapse:collapse;width:100%;min-width:900px
}
th,td{
border:1px solid #ddd;
padding:6px;text-align:center;font-size:13px
}
th{background:#f1f1f1}
.student-row input{
width:60px
}
.name{width:120px}
.roll{width:50px}

/* STUDENT VIEW */
.student{
background:#f6f7fb;border-radius:10px;
padding:10px;margin-top:8px
}
</style>
</head>
<body>

<!-- INDEX PAGE -->
<div id="index">
  <div>
    <h1>STUDENT MARKS</h1>
    <button onclick="startApp()">Enter</button>
  </div>
</div>

<!-- APP -->
<div id="app" style="display:none">

<div class="header">WHOLE CLASS MARKS</div>

<!-- HOME -->
<div class="screen active" id="home">
<div class="card">
<button onclick="openScreen('add')">üìù Enter Class Marks</button>
<button onclick="openScreen('view')">üìã View Students</button>
<button onclick="openScreen('analysis')">üìä Analysis</button>
</div>
</div>

<!-- ADD WHOLE CLASS -->
<div class="screen" id="add">
<div class="card">
<h3>Enter Whole Class Marks</h3>
<input id="cls" placeholder="Class / Section">
<input type="number" id="outof" placeholder="Out of Marks (per subject)">
<input type="number" id="count" placeholder="Number of Students">
<button onclick="createClassTable()">Create Table</button>

<div class="table-wrap">
<table id="classTable"></table>
</div>

<button onclick="saveClass()">Save Class</button>
<button onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- VIEW -->
<div class="screen" id="view">
<div class="card">
<h3>All Students</h3>
<div id="list"></div>
<button onclick="openScreen('home')">Back</button>
</div>
</div>

<!-- ANALYSIS -->
<div class="screen" id="analysis">
<div class="card">
<h3>Class Analysis</h3>
<div id="analysisData"></div>
<button onclick="openScreen('home')">Back</button>
</div>
</div>

<script>
const subjects=["TELUGU","HINDI","ENGLISH","MATHS","SCIENCE","SOCIAL"];

function startApp(){
index.style.display="none";
app.style.display="block";
}

function openScreen(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
if(id==="view") showStudents();
if(id==="analysis") analyzeClass();
}

function createClassTable(){
let n=Number(document.getElementById('count').value||0);
let out=Number(document.getElementById('outof').value||0);
if(n<1){alert("Enter number of students"); return;}
if(out<1){alert("Enter out of marks"); return;}

let table=document.getElementById('classTable');
let html='<tr><th>Roll</th><th>Name</th>';
subjects.forEach(s=>{html+='<th>'+s+'</th>'});
html+='<th>Total</th><th>%</th></tr>';

for(let i=0;i<n;i++){
html+='<tr class="student-row">';
html+='<td><input class="roll" type="number" placeholder="Roll"></td>';
html+='<td><input class="name" placeholder="Name"></td>';
for(let j=0;j<subjects.length;j++){
html+='<td><input type="number"></td>';
}
html+='<td class="total">0</td><td class="percent">0%</td></tr>';
}
table.innerHTML=html;
}

function saveClass(){
let table=document.getElementById('classTable');
let cls=document.getElementById('cls').value;
let out=Number(document.getElementById('outof').value||0);
if(!cls||!out){alert("Enter class and out of marks");return;}

let db=JSON.parse(localStorage.getItem("students"))||[];
let rows=table.querySelectorAll('.student-row');

rows.forEach(r=>{
let roll=r.querySelector('.roll').value||"";
let name=r.querySelector('.name').value||"";
let marks=[...r.querySelectorAll('td input')].slice(2).map(i=>Number(i.value||0));
let total=marks.reduce((a,b)=>a+b,0);
let totalOut=out*subjects.length;
let percent=((total/totalOut)*100).toFixed(2);
r.querySelector('.total').innerText=total;
r.querySelector('.percent').innerText=percent+'%';

db.push({roll,name,cls,marks,total,totalOut,percent});
});
localStorage.setItem('students',JSON.stringify(db));
alert("Class saved successfully ‚úÖ");
openScreen('home');
}

function showStudents(){
let db=JSON.parse(localStorage.getItem('students'))||[];
if(!db.length){list.innerHTML="No data"; return;}
list.innerHTML=db.map(s=>`
<div class="student">
<b>${s.name}</b> (Roll ${s.roll})<br>
Class: ${s.cls}<br>
Marks: ${s.marks.join(', ')}<br>
Total: ${s.total}/${s.totalOut} | ${s.percent}%
</div>`).join('');
}

function analyzeClass(){
let db=JSON.parse(localStorage.getItem('students'))||[];
if(!db.length){analysisData.innerHTML="No data"; return;}
let top=db.reduce((a,b)=>a.percent>b.percent?a:b);
let low=db.reduce((a,b)=>a.percent<b.percent?a:b);
analysisData.innerHTML=`<b>Topper:</b> ${top.name} (${top.percent}%)<br><br>
<b>Lowest:</b> ${low.name} (${low.percent}%)`;
}
</script>
</body>
</html>
